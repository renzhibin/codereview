重构：使用配置驱动的反射工厂，提升扩展性