{"version":"1.119.0","results":[{"check_id":"spring-missing-authorization-check-get","path":"src/main/java/com/vuln/demo/controller/OrderController.java","start":{"line":22,"col":5,"offset":596},"end":{"line":45,"col":6,"offset":1564},"extra":{"message":"检测到缺少授权检查的 GET 端点。\n该方法接收路径参数（如 userId, orderId）但没有验证当前用户是否有权访问该资源。\n这可能导致水平越权（IDOR）漏洞，攻击者可以通过修改 ID 参数访问其他用户的数据。\n\n建议修复：\n1. 在返回数据前检查资源是否属于当前用户\n2. 或验证当前用户是否有管理员权限\n\n示例代码：\n```java\nif (order.getUserId() != currentUserId && !isAdmin(currentUser)) {\n    return ResponseEntity.status(403).build();\n}\n```\n","metadata":{"category":"security","cwe":"CWE-639: Authorization Bypass Through User-Controlled Key","owasp":"A01:2021 - Broken Access Control","vulnerability_class":"Insecure Direct Object Reference (IDOR)"},"severity":"ERROR","fingerprint":"requires login","lines":"requires login","validation_state":"NO_VALIDATOR","engine_kind":"OSS"}},{"check_id":"spring-weak-authentication-header","path":"src/main/java/com/vuln/demo/controller/OrderController.java","start":{"line":25,"col":13,"offset":717},"end":{"line":25,"col":66,"offset":770},"extra":{"message":"检测到使用自定义 HTTP Header 进行身份验证（如 X-User-Id）。\n这是不安全的做法，因为客户端可以任意伪造 Header 值。\n\n建议修复：\n1. 使用 Spring Security 进行身份验证\n2. 使用 JWT 或 Session 进行用户识别\n3. 不要信任客户端直接传递的用户 ID\n","metadata":{"category":"security","cwe":"CWE-287: Improper Authentication","owasp":"A07:2021 - Identification and Authentication Failures"},"severity":"WARNING","fingerprint":"requires login","lines":"requires login","validation_state":"NO_VALIDATOR","engine_kind":"OSS"}},{"check_id":"spring-repository-findbyid-without-ownership-check","path":"src/main/java/com/vuln/demo/controller/OrderController.java","start":{"line":27,"col":36,"offset":837},"end":{"line":27,"col":69,"offset":870},"extra":{"message":"检测到使用 repository.findById() 查询数据但没有验证所有权。\n在返回数据给用户前，应该验证该资源是否属于当前用户。\n\n建议修复：\n在返回数据前添加所有权检查。\n","metadata":{"category":"security","cwe":"CWE-639: Authorization Bypass Through User-Controlled Key","owasp":"A01:2021 - Broken Access Control"},"severity":"WARNING","fingerprint":"requires login","lines":"requires login","validation_state":"NO_VALIDATOR","engine_kind":"OSS"}},{"check_id":"spring-missing-authorization-check-put","path":"src/main/java/com/vuln/demo/controller/OrderController.java","start":{"line":48,"col":5,"offset":1639},"end":{"line":74,"col":6,"offset":2708},"extra":{"message":"检测到缺少授权检查的 PUT 端点。\n该方法允许修改资源但没有验证当前用户是否有权修改该资源。\n这可能导致水平越权漏洞，攻击者可以修改其他用户的数据。\n\n建议修复：\n在修改资源前验证资源所有权或管理员权限。\n","metadata":{"category":"security","cwe":"CWE-639: Authorization Bypass Through User-Controlled Key","owasp":"A01:2021 - Broken Access Control","vulnerability_class":"Insecure Direct Object Reference (IDOR)"},"severity":"ERROR","fingerprint":"requires login","lines":"requires login","validation_state":"NO_VALIDATOR","engine_kind":"OSS"}},{"check_id":"spring-weak-authentication-header","path":"src/main/java/com/vuln/demo/controller/OrderController.java","start":{"line":52,"col":13,"offset":1813},"end":{"line":52,"col":66,"offset":1866},"extra":{"message":"检测到使用自定义 HTTP Header 进行身份验证（如 X-User-Id）。\n这是不安全的做法，因为客户端可以任意伪造 Header 值。\n\n建议修复：\n1. 使用 Spring Security 进行身份验证\n2. 使用 JWT 或 Session 进行用户识别\n3. 不要信任客户端直接传递的用户 ID\n","metadata":{"category":"security","cwe":"CWE-287: Improper Authentication","owasp":"A07:2021 - Identification and Authentication Failures"},"severity":"WARNING","fingerprint":"requires login","lines":"requires login","validation_state":"NO_VALIDATOR","engine_kind":"OSS"}},{"check_id":"spring-missing-authorization-check-delete","path":"src/main/java/com/vuln/demo/controller/OrderController.java","start":{"line":77,"col":5,"offset":2783},"end":{"line":95,"col":6,"offset":3538},"extra":{"message":"检测到缺少授权检查的 DELETE 端点。\n该方法允许删除资源但没有验证当前用户是否有权删除该资源。\n这可能导致水平越权漏洞，攻击者可以删除其他用户的数据。\n\n建议修复：\n在删除资源前验证资源所有权或管理员权限。\n","metadata":{"category":"security","cwe":"CWE-639: Authorization Bypass Through User-Controlled Key","owasp":"A01:2021 - Broken Access Control","vulnerability_class":"Insecure Direct Object Reference (IDOR)"},"severity":"ERROR","fingerprint":"requires login","lines":"requires login","validation_state":"NO_VALIDATOR","engine_kind":"OSS"}},{"check_id":"spring-weak-authentication-header","path":"src/main/java/com/vuln/demo/controller/OrderController.java","start":{"line":80,"col":13,"offset":2906},"end":{"line":80,"col":66,"offset":2959},"extra":{"message":"检测到使用自定义 HTTP Header 进行身份验证（如 X-User-Id）。\n这是不安全的做法，因为客户端可以任意伪造 Header 值。\n\n建议修复：\n1. 使用 Spring Security 进行身份验证\n2. 使用 JWT 或 Session 进行用户识别\n3. 不要信任客户端直接传递的用户 ID\n","metadata":{"category":"security","cwe":"CWE-287: Improper Authentication","owasp":"A07:2021 - Identification and Authentication Failures"},"severity":"WARNING","fingerprint":"requires login","lines":"requires login","validation_state":"NO_VALIDATOR","engine_kind":"OSS"}},{"check_id":"spring-admin-endpoint-missing-role-check","path":"src/main/java/com/vuln/demo/controller/OrderController.java","start":{"line":98,"col":5,"offset":3625},"end":{"line":114,"col":6,"offset":4395},"extra":{"message":"检测到管理员端点缺少角色检查。\n该方法路径包含 '/admin/' 但没有验证当前用户是否具有管理员权限。\n这可能导致垂直越权漏洞，普通用户可以访问管理员功能。\n\n建议修复：\n添加角色检查或使用 Spring Security 的 @PreAuthorize 注解。\n\n示例代码：\n```java\n@PreAuthorize(\"hasRole('ADMIN')\")\n@GetMapping(\"/admin/...\")\npublic ResponseEntity<?> adminMethod(...) { ... }\n```\n","metadata":{"category":"security","cwe":"CWE-284: Improper Access Control","owasp":"A01:2021 - Broken Access Control","vulnerability_class":"Vertical Privilege Escalation"},"severity":"ERROR","fingerprint":"requires login","lines":"requires login","validation_state":"NO_VALIDATOR","engine_kind":"OSS"}},{"check_id":"spring-weak-authentication-header","path":"src/main/java/com/vuln/demo/controller/OrderController.java","start":{"line":99,"col":44,"offset":3696},"end":{"line":99,"col":97,"offset":3749},"extra":{"message":"检测到使用自定义 HTTP Header 进行身份验证（如 X-User-Id）。\n这是不安全的做法，因为客户端可以任意伪造 Header 值。\n\n建议修复：\n1. 使用 Spring Security 进行身份验证\n2. 使用 JWT 或 Session 进行用户识别\n3. 不要信任客户端直接传递的用户 ID\n","metadata":{"category":"security","cwe":"CWE-287: Improper Authentication","owasp":"A07:2021 - Identification and Authentication Failures"},"severity":"WARNING","fingerprint":"requires login","lines":"requires login","validation_state":"NO_VALIDATOR","engine_kind":"OSS"}},{"check_id":"spring-missing-authorization-check-get","path":"src/main/java/com/vuln/demo/controller/UserController.java","start":{"line":23,"col":5,"offset":697},"end":{"line":38,"col":6,"offset":1458},"extra":{"message":"检测到缺少授权检查的 GET 端点。\n该方法接收路径参数（如 userId, orderId）但没有验证当前用户是否有权访问该资源。\n这可能导致水平越权（IDOR）漏洞，攻击者可以通过修改 ID 参数访问其他用户的数据。\n\n建议修复：\n1. 在返回数据前检查资源是否属于当前用户\n2. 或验证当前用户是否有管理员权限\n\n示例代码：\n```java\nif (order.getUserId() != currentUserId && !isAdmin(currentUser)) {\n    return ResponseEntity.status(403).build();\n}\n```\n","metadata":{"category":"security","cwe":"CWE-639: Authorization Bypass Through User-Controlled Key","owasp":"A01:2021 - Broken Access Control","vulnerability_class":"Insecure Direct Object Reference (IDOR)"},"severity":"ERROR","fingerprint":"requires login","lines":"requires login","validation_state":"NO_VALIDATOR","engine_kind":"OSS"}},{"check_id":"spring-repository-findbyid-without-ownership-check","path":"src/main/java/com/vuln/demo/controller/UserController.java","start":{"line":27,"col":31,"offset":993},"end":{"line":27,"col":62,"offset":1024},"extra":{"message":"检测到使用 repository.findById() 查询数据但没有验证所有权。\n在返回数据给用户前，应该验证该资源是否属于当前用户。\n\n建议修复：\n在返回数据前添加所有权检查。\n","metadata":{"category":"security","cwe":"CWE-639: Authorization Bypass Through User-Controlled Key","owasp":"A01:2021 - Broken Access Control"},"severity":"WARNING","fingerprint":"requires login","lines":"requires login","validation_state":"NO_VALIDATOR","engine_kind":"OSS"}},{"check_id":"spring-missing-authorization-check-put","path":"src/main/java/com/vuln/demo/controller/UserController.java","start":{"line":42,"col":5,"offset":1613},"end":{"line":66,"col":6,"offset":2650},"extra":{"message":"检测到缺少授权检查的 PUT 端点。\n该方法允许修改资源但没有验证当前用户是否有权修改该资源。\n这可能导致水平越权漏洞，攻击者可以修改其他用户的数据。\n\n建议修复：\n在修改资源前验证资源所有权或管理员权限。\n","metadata":{"category":"security","cwe":"CWE-639: Authorization Bypass Through User-Controlled Key","owasp":"A01:2021 - Broken Access Control","vulnerability_class":"Insecure Direct Object Reference (IDOR)"},"severity":"ERROR","fingerprint":"requires login","lines":"requires login","validation_state":"NO_VALIDATOR","engine_kind":"OSS"}},{"check_id":"spring-weak-authentication-header","path":"src/main/java/com/vuln/demo/controller/UserController.java","start":{"line":46,"col":13,"offset":1781},"end":{"line":46,"col":66,"offset":1834},"extra":{"message":"检测到使用自定义 HTTP Header 进行身份验证（如 X-User-Id）。\n这是不安全的做法，因为客户端可以任意伪造 Header 值。\n\n建议修复：\n1. 使用 Spring Security 进行身份验证\n2. 使用 JWT 或 Session 进行用户识别\n3. 不要信任客户端直接传递的用户 ID\n","metadata":{"category":"security","cwe":"CWE-287: Improper Authentication","owasp":"A07:2021 - Identification and Authentication Failures"},"severity":"WARNING","fingerprint":"requires login","lines":"requires login","validation_state":"NO_VALIDATOR","engine_kind":"OSS"}},{"check_id":"spring-role-modification-missing-check","path":"src/main/java/com/vuln/demo/controller/UserController.java","start":{"line":62,"col":9,"offset":2458},"end":{"line":62,"col":30,"offset":2479},"extra":{"message":"检测到角色修改功能缺少权限检查。\n该方法允许修改用户角色但没有验证操作者是否为管理员。\n这是严重的垂直越权漏洞，普通用户可能将自己提升为管理员。\n\n建议修复：\n必须验证当前用户具有管理员权限才能修改角色。\n","metadata":{"category":"security","cwe":"CWE-269: Improper Privilege Management","owasp":"A01:2021 - Broken Access Control","vulnerability_class":"Vertical Privilege Escalation"},"severity":"ERROR","fingerprint":"requires login","lines":"requires login","validation_state":"NO_VALIDATOR","engine_kind":"OSS"}},{"check_id":"spring-admin-endpoint-missing-role-check","path":"src/main/java/com/vuln/demo/controller/UserController.java","start":{"line":69,"col":5,"offset":2740},"end":{"line":76,"col":6,"offset":3135},"extra":{"message":"检测到管理员端点缺少角色检查。\n该方法路径包含 '/admin/' 但没有验证当前用户是否具有管理员权限。\n这可能导致垂直越权漏洞，普通用户可以访问管理员功能。\n\n建议修复：\n添加角色检查或使用 Spring Security 的 @PreAuthorize 注解。\n\n示例代码：\n```java\n@PreAuthorize(\"hasRole('ADMIN')\")\n@GetMapping(\"/admin/...\")\npublic ResponseEntity<?> adminMethod(...) { ... }\n```\n","metadata":{"category":"security","cwe":"CWE-284: Improper Access Control","owasp":"A01:2021 - Broken Access Control","vulnerability_class":"Vertical Privilege Escalation"},"severity":"ERROR","fingerprint":"requires login","lines":"requires login","validation_state":"NO_VALIDATOR","engine_kind":"OSS"}},{"check_id":"spring-weak-authentication-header","path":"src/main/java/com/vuln/demo/controller/UserController.java","start":{"line":70,"col":42,"offset":2807},"end":{"line":70,"col":95,"offset":2860},"extra":{"message":"检测到使用自定义 HTTP Header 进行身份验证（如 X-User-Id）。\n这是不安全的做法，因为客户端可以任意伪造 Header 值。\n\n建议修复：\n1. 使用 Spring Security 进行身份验证\n2. 使用 JWT 或 Session 进行用户识别\n3. 不要信任客户端直接传递的用户 ID\n","metadata":{"category":"security","cwe":"CWE-287: Improper Authentication","owasp":"A07:2021 - Identification and Authentication Failures"},"severity":"WARNING","fingerprint":"requires login","lines":"requires login","validation_state":"NO_VALIDATOR","engine_kind":"OSS"}},{"check_id":"spring-missing-authorization-check-get","path":"src/main/java/com/vuln/demo/controller/UserController.java","start":{"line":79,"col":5,"offset":3245},"end":{"line":85,"col":6,"offset":3676},"extra":{"message":"检测到缺少授权检查的 GET 端点。\n该方法接收路径参数（如 userId, orderId）但没有验证当前用户是否有权访问该资源。\n这可能导致水平越权（IDOR）漏洞，攻击者可以通过修改 ID 参数访问其他用户的数据。\n\n建议修复：\n1. 在返回数据前检查资源是否属于当前用户\n2. 或验证当前用户是否有管理员权限\n\n示例代码：\n```java\nif (order.getUserId() != currentUserId && !isAdmin(currentUser)) {\n    return ResponseEntity.status(403).build();\n}\n```\n","metadata":{"category":"security","cwe":"CWE-639: Authorization Bypass Through User-Controlled Key","owasp":"A01:2021 - Broken Access Control","vulnerability_class":"Insecure Direct Object Reference (IDOR)"},"severity":"ERROR","fingerprint":"requires login","lines":"requires login","validation_state":"NO_VALIDATOR","engine_kind":"OSS"}}],"errors":[],"paths":{"scanned":["src/main/java/com/vuln/demo/VulnDemoApplication.java","src/main/java/com/vuln/demo/config/DataInitializer.java","src/main/java/com/vuln/demo/controller/OrderController.java","src/main/java/com/vuln/demo/controller/UserController.java","src/main/java/com/vuln/demo/model/Order.java","src/main/java/com/vuln/demo/model/User.java","src/main/java/com/vuln/demo/repository/OrderRepository.java","src/main/java/com/vuln/demo/repository/UserRepository.java"]},"skipped_rules":[]}